# NyxoWealth Permissions System - Version 2.0\n\n## Overview\nThis document outlines the comprehensive permission system for NyxoWealth v2.0. Permissions are granular and organized by functional area, allowing precise access control for team members.\n\n---\n\n## Permission Categories\n\n### 1. Financial Management - Invoices\n- **view_invoices** - View invoice list and details\n- **create_invoices** - Create new invoices\n- **edit_invoices** - Edit existing invoices and change status\n- **delete_invoices** - Delete invoices\n- **export_invoices** - Export invoices to PDF/Excel\n\n### 2. Financial Management - Transactions\n- **view_transactions** - View transaction history and records\n- **create_transactions** - Record new income/expense transactions\n- **edit_transactions** - Edit existing transactions\n- **delete_transactions** - Delete transaction records\n\n### 3. Financial Management - Reports & Analytics\n- **view_reports** - Access business reports and dashboards\n- **export_reports** - Export report data to CSV/Excel\n\n### 4. Team & Operations - Customers\n- **view_customers** - View customer list and details\n- **create_customers** - Add new customers\n- **edit_customers** - Edit customer information\n- **delete_customers** - Remove customers\n\n### 5. Team & Operations - Employees\n- **view_employees** - View employee roster\n- **create_employees** - Add new employees\n- **edit_employees** - Edit employee details\n- **delete_employees** - Remove employees\n\n### 6. Team & Operations - Payroll\n- **view_payroll** - View payroll information and summaries\n- **manage_payroll** - Create and manage payroll records\n\n### 7. Business Setup - Products\n- **view_products** - View product/service catalog\n- **create_products** - Add new products/services\n- **edit_products** - Edit product details and pricing\n- **delete_products** - Remove products/services\n\n### 8. Business Setup - Templates\n- **manage_templates** - Create and customize invoice templates\n\n### 9. Business Setup - Settings\n- **manage_settings** - Edit business information, currency, tax settings\n\n### 10. Administration\n- **manage_users** - Create/edit/delete user accounts and roles\n- **view_activity_logs** - View system audit logs and activity history\n\n---\n\n## Role-Based Permission Sets\n\n### Admin Role\n*Has access to ALL permissions by default*\n\n### Accountant Role (Recommended)\n```\n- view_invoices\n- create_invoices\n- edit_invoices\n- delete_invoices\n- export_invoices\n- view_transactions\n- create_transactions\n- edit_transactions\n- view_customers\n- view_products\n- view_reports\n- export_reports\n- manage_settings\n```\n\n### Sales Manager Role (Recommended)\n```\n- view_invoices\n- create_invoices\n- view_customers\n- create_customers\n- edit_customers\n- view_products\n- view_reports\n- export_reports\n```\n\n### HR Manager Role (Recommended)\n```\n- view_employees\n- create_employees\n- edit_employees\n- delete_employees\n- view_payroll\n- manage_payroll\n- view_reports\n```\n\n### Viewer Role (Recommended)\n```\n- view_invoices\n- view_customers\n- view_products\n- view_employees\n- view_reports\n```\n\n---\n\n## Implementation Details\n\n### Frontend (main.js)\n- Permission checks use the `hasPermission(perm)` function\n- UI elements are hidden using `data-perm` attributes\n- The `updateUiPermissions()` function enforces permissions on page load\n\n### Backend (Rust - commands.rs)\n- All write operations require `check_permission(&auth, \"permission_name\")`\n- Read operations may or may not require permissions (configurable)\n- Audit logs are automatically created for all permission-protected actions\n\n### Database\n- User permissions are stored in the `user_permissions` table\n- Admin users bypass individual permission checks\n\n---\n\n## Migration from V1.0\n\n### Deprecated Permissions (V1.0)\n- `manage_customers` → `view_customers`, `create_customers`, `edit_customers`, `delete_customers`\n- `manage_products` → `view_products`, `create_products`, `edit_products`, `delete_products`\n- `manage_transactions` → `view_transactions`, `create_transactions`, `edit_transactions`, `delete_transactions`\n- `manage_payroll` → `view_payroll`, `manage_payroll` (split for view/modify)\n- `create_invoice` → `create_invoices`\n- `delete_invoice` → `delete_invoices`\n- `view_logs` → `view_activity_logs`\n\n### Upgrade Path\n1. Existing users with `manage_customers` will need to be assigned granular customer permissions\n2. A migration script should be run to map old permissions to new ones:\n   - `manage_customers` → all 4 customer permissions\n   - `manage_products` → all 4 product permissions\n   - `manage_transactions` → all transaction permissions\n\n---\n\n## Best Practices\n\n1. **Principle of Least Privilege** - Only assign permissions necessary for the role\n2. **Regular Audits** - Review user permissions monthly\n3. **Activity Monitoring** - Check activity logs for suspicious access patterns\n4. **Clear Role Definitions** - Use provided role templates or create custom roles with clear documentation\n5. **Segregation of Duties** - Separate invoice creation from approval/deletion where possible\n6. **Secure Defaults** - New users should have minimal permissions\n\n---\n\n## Testing Checklist\n\n- [ ] Admin users can access all features\n- [ ] Regular users with appropriate permissions can perform their roles\n- [ ] Users without permissions see permission denied messages\n- [ ] Permission changes take effect immediately\n- [ ] Activity logs record all permission-protected actions\n- [ ] Audit reports show who made changes and when\n\n---\n\n*Last Updated: February 14, 2026*\n*Version: 2.0*\n